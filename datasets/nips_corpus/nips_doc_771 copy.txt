A Computational Model 
for Cursive Handwriting 
Based on the Minimization Principle 
Yasuhiro Wada * Yasuharu Koike 
Eric Vatikiotis-Bateson 
Mitsuo Kawato 
ATR Human Information Processing Research Laboratories 
2-2 Hikaridai, Seika-cho, Soraku-gun, Kyoto 619-02, Japan 
ABSTRACT 
We propose a trajectory planning and control theory for continuous 
movements such as connected cursive handwriting and continuous 
natural speech. Its hardware is based on our previously proposed 
forward-inverse-relaxation neural network (Wada & Kawato, 1993). 
Computationally, its optimization principle is the minimum torque- 
change criterion. Regarding the representation level, hard constraints 
satisfied by a trajectory are represented as a set of via-points extracted 
from a handwritten character. Accordingly, we propose a via-point 
estimation algorithm that estimates via-points by repeating the 
trajectory formation of a character and the via-point extraction from the 
character. In experiments, good quantitative agreement is found 
between human handwriting data and the trajectories generated by the 
theory. Finally, we propose a recognition schema based on the 
movement generation. We show a result in which the recognition 
schema is applied to the handwritten character recognition and can be 
extended to the phoneme timing estimation of natural speech. 
1 INTRODUCTION 
In reaching movements, trajectory formation is an ill-posed problem because the hand 
can move along an infinite number of possible trajectories from the starting to the target 
point. However, humans move an arm between two targets along consistent one of an 
*' Present Address: Systems Lab., Kawasaki Steel Corporation, 
Makuhari Techno Garden, 1-3.Nakase, Mihama-ku, Chiba 261, Japan 
727 
728 Wada, Koike, Vatikiotis-Bateson, and Kawato 
infinite number of trajectories. Therefore, the brain should be able to compute a unique 
solution by imposing an appropriate criterion to the ill-posed problem. Especially, a 
smoothness performance index was intensively studied in this context. 
Flash & Hogan (1985) proposed a mathematical model, the minimum-jerk model. Their 
model is based on the kinematics of movement, independent of the dynamics of the 
musculoskeletal system. On the other hand, based on the idea that the objective function 
must be related to dynamics, Uno, Kawato & Suzuki (1989) proposed the minimum 
torque-change criterion which accounts for the desired trajectory determination. The 
criterion is based on the theory that the trajectory of the human arm is determined so as to 
minimize the time integral of the square of the rate of torque change. They proposed the 
following quadratic measure of performance. Where :J is the torque generated by the j- 
th actuator of M actuators, and tfis the movement time. 
Handwriting production is an attractive subject in human motor control studies. In 
cursive handwriting, a symbol must be transformed into a motor command stream. This 
transformation process raises several questions. How can the central nervous system 
(CNS) represent a character symbol for producing a handwritten letter? By what principle 
can motor planning be made or a motor command be produced? In this paper we propose 
a handwriting model whose computational theory and representation are the same as the 
model in reaching movements. Our proposed computational model for cursive 
handwriting is assumed to generate a trajectory that passes through many via-points. The 
computational theory is based on the minimum torque-change criterion, and a 
representation of a character is assumed to be expressed as a set of via-points extracted 
from a handwritten character. In reaching movement, the boundary condition is given by 
the visual information, such as the location of a cup, and the trajectory formation is based 
on the minimum torque-change criterion, which is completely the same as the model of 
handwriting (Fig. 1). However, it is quite difficult to determine the via-points in order to 
reproduce a cursive handwritten character. We propose an algorithm that can determine 
the via-points of the handwritten character, based only on the same minimization 
principle and which does not use any other ad hoc information such as zero-crossing 
velocity (Holierbach, 1981). 
Representation 
Reaching 
(reach to  
the object) 
Handwriting  
(write a character) 
Location 
of he object 
..i_su___al__ I_ n.f.o..rm ation 
Via-Point 
(representation 
of character) - 
Via-Point Estimation 
Al.....jgi. th m 
Computational Hardware 
Theory 
Figure 1: A handwriting model. 
A Computational Model for Cursive Handwriting Based on the Minimization Principle 729 
2 PREVIOUS WORK ON THE HANDWRITING MODEL 
Several handwriting models (Holierbach, 1981; Morasso & Mussa-Ivaldi, 1982; Edleman 
& Flash, 1987) have been proposed. Holierbach proposed a handwriting model based on 
oscillation theory. The model basically used a vertical oscillator and a horizontal 
oscillator. Morasso & Mussa-Ivaldi proposed a trajectory formation model using a spline 
function, and realized a handwritten character using the formation model. 
Edleman & Flash (1987) proposed a handwriting model based on snap (fourth derivative 
of position) minimization. The representation of a character was four basic strokes and a 
handwritten character was regenerated by a combination of several strokes. However, 
their model was different from their theory for reaching movement. Flash & Hogan 
(1985) have proposed the minimum jerk criterion in the reaching movement. 
3 A HANDWRITING MODEL 
3.1 Trajectory formation neural network: 
Forward-Inverse Relaxation Model (FIRM) 
First, we explain the trajectory formation neural network. Because the dynamics of the 
human arm are nonlinear, finding a unique trajectory based on the minimum torque- 
change criterion is a nonlinear optimization problem. Moreover, it is rather difficult. 
There are several criticisms of previous proposed neural networks based on the minimum 
torque-change criterion: (1) their spatial representation of time, (2) back propagation is 
essential, and (3) much time is required. Therefore, we have proposed a new neural 
network, FIRM(Forward-Inverse Relaxation Model) for trajectory formation (Wada & 
Kawato, 1993). This network can be implemented as a biologically plausible neural 
network and resolve the above criticisms. 
3.2 Via-point estimation model 
Edelman & Flash (1987) have pointed out the difficulty of finding the via-points in a 
handwritten character. They have argued two points: (1) the number of via-points, (2) a 
reason for the choice of every via-point locus. It is clear in approximation theory that a 
character can be regenerated perfectly if the number of extracted via-points is large. 
Appropriate via-points can not be assigned according to a regular sampling rule if the 
sample duration is constant and long. Therefore, there is an infinite number of 
combinations of numbers and via-point positions in the problem of extracting via-points 
from a given trajectory, and a unique solution can not be found if a trajectory reformation 
theory is not identified. That is, it is an ill-posed problem. 
The algorithm for assigning the via-points finds the via-points by iteratively activating 
both the trajectory formation module (FIRM) and the via-point extraction module (Fig. 
2). The trajectory formation module generates a trajectory based on the minimum torque- 
change criterion using the via-points which are extracted by the via-point extraction 
module. The via-point extraction module assigns the via-points so as to minimize the 
square error between the given trajectory and the trajectory generated by the trajectory 
formation module. The via-point extraction algorithm will stop when the error between 
the given trajectory and the trajectory generated from the extracted via-points reaches a 
threshold. 
730 Wada, Koike, Vatikiotis-Bateson, and Kawato 
Via-Points Extraction Module 
ft'r[(O(t )-O,.(t))dt  Min 
Via-points assignment to 
decrease the above trajectory 
error 
Minimum Torque- 
Change Trajectory 
Via-Point 
Information 
(Position ï¿½ Time) 
Trajectory Formation Module 
(FIRM) 
 dt  Min 
Trajectory generation 
based on minimum torque- 
change criterion 
Figure 2: Via-point estimation model. Ot(t) is the given trajectory of the j-th joint angle 
and o(t) represents the generated trajectory. 
3.2.1 Algorithm of via-point extraction 
There are a via-point extraction procedure and a trajectory production procedure in the 
via-point extraction module, and they are iteratively computed. Trajectory production in 
the module is based on the minimum-jerk model (Flash & Hogan 1985 ) on a joint angle 
space, which is equivalent to the minimum torque-change model when arm dynamics are 
approximated as in the following dynamic equation: 
J = lJ j (j= 1,..., M) (2) 
where I j and t j are the inertia of the link and the acceleration of the j-th joint angle, 
respectively. 
The algorithm for via-point extraction is illustrated in Fig. 3. The procedural sequence is 
as follows: 
(Step 1) A trajectory between a starting point and a final point is generated by using the 
minimum torque-change principle of the linear dynamics model. 
(Step 2) The point with the maximum square error value between the given trajectory and 
the generated trajectory is selected as a via-point candidate. 
(Step 3) If the maximum value of the square error is less than the preassigned threshold, 
the procedure described above is finished. If the maximum value of the square error is 
greater than the threshold, the via-point candidate is assigned as via-point i and a 
trajectory is generated from the starting point through the via-point i to the final point. 
This generated trajectory is added to the trajectory that has already been generated. The 
time of the start point of the generated trajectory is a via-point located just before the 
assig
