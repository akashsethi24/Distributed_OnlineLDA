95 
OPTIMAL NEURAL SPIKE CLASSIFICATION 
Amir F. Atiya(*) and Ja,nes M. Bower(**) 
(*) Dept. of Electrical Engineering 
(**) Division of Biology 
California Institute of Technology 
Ca 91125 
Abstract 
Being able to record the electrical activities of a number of neurons simultaneously is likely 
to be important in the study of the functional organization of networks of real neurons. Using 
one extracellular microelectrode to record from several neurons is one approach to studying 
the response properties of sets of adjacent and therefore likely related neurons. However, to 
do this, it is necessary to correctly classify the signals generated by these different neurons. 
This paper considers this problem of classifying the signals in such an extracellular recording, 
based upon their shapes, and specifically considers the classification of signals in the case when 
spikes overlap temporally. 
Introduction 
How single neurons in a network of neurons interact when processing information is likely 
to be a fundamental question central to understanding how real neural networks compute,. 
In the mammalian nervous system we know that spatially adjacent neurons are, in general, 
more hkely to interact, as well as receive common inputs. Thus neurobiologists are interested 
in devising techniques that allow adjacent groups of neurons to be sampled simultaneously. 
Unfortunately, the small scale of real neural networks makes inserting one recording electrode 
per cell impractical. Therefore, one is forced to use single electrodes designed to sample neu- 
ral signals evoked by several cells at once. While this approach provides the multi-neuron 
recordings being sought, it also presents a rather serious waveform classification problem be- 
cause the actual temporal sequence of action potentials in each individual neuron must be 
deciphered. This paper describes a method for classifying the activities of several individual 
neurons recorded simultaneously using a single electrode. 
Description of the Problem 
Over the last two decades considerable attention 1'8 has been devoted to the problem of 
classification of action potentials in multi-neuron recordings. These action potentials (also 
referred to as spikes) are the extracellularly recorded signal produced by a single neuron 
when it is passing information to other neurons (Fig. 1). Fortunately, spikes recorded from the 
same cell are more or less similar in shape, while spikes coming from different neurons usually 
have somewhat different shapes, depending on the neuron type, electrode characteristics, the 
distance between the electrode and the neuron, and the intervening medium. Fig. I illustrates 
some representative variations in spike shapes. It is our objective to detect and classify different 
spikes based on their shapes. However, relying entirely on the shape of the spikes presents 
difficulties. For example spikes from different neurons can overlap temporally producing novel 
waveforms (see Fig. 2 for an example of an overlap). To deal with these overlaps, one has first 
to detect the occurrence of an overlap, and then estimate the constituent spikes. Unfortunately, 
only a few of the available spike separation algorithms consider these events, even though they 
are potentially very important in understanding neural networks. Those few tend to rely 
American Institute of Physics 1988 
96 
on heuristic rules and subtractive methods to resolve overlap cases. No currently published 
method we are aware of attempts to use knowledge of the likelihood of overlap events for 
detecting them, which is at the basis of the method we will describe. 
Fig. 1 
An example of a multi-neuron recording 
overlapping spikes 
Fig. 2 
An example of a temporal overlap of action potentials 
General Approach 
The first step in classifying neural waveforms is obviously to identify the typical spike 
shapes occurring in a particular recording. To do this we have applied a learning algorithm 
on the beginning portion of the recording, which in an unsupervised fashion (i.e. without the 
intervention of a human operator) estimates the shapes. After the learning stage we have 
the classification stage, which is applied on the remaining portion of the recording. A new 
classification method is proposed, which gives minimum probability of error, even in case of the 
occurrence of overlapping spikes. Both the learning and the classification algorithms require 
a preprocessing step to detect the position of the spike candidate in the data record. 
Detectior: For the first task of detection most researchers use a simple level detecting 
algorithm, that signals a spike when recorded voltage levels cross a certain voltage threshold. 
However, variations in recording position due to natural brain movements during recording 
(e.g. respiration) can cause changes in relative height of the positive to the negative peak. 
Thus, a level detector (using either a positive or a negative threshold) can miss some spikes. 
Alternatively, we have chosen to detect an event by sliding a window of fixed length until a 
time when the peak to peak value within the window exceeds a certain threshold. 
Learning: Learning is performed on the beginning portion of the sampled data using 
the Isodata clustering algorithm 9. The task is to estimate the number of neurons n whose 
spikes are represented in the waveform and learn the different shapes of the spikes of the 
various neurons. For that purpose we apply the clustering algorithm choosing only one feature 
97 
from the spike, the peak to peak value which we have found to be quite an effective feature. 
Note that using the peak to peak value in the learning stage does not necessitate using it for 
classification (one might need additional or different features, especially for tackling the case 
of spike overlap). 
The Optimal Classification Rule: Once we have identified the number of different events 
present, the classification stage is concerned with estimating the identities of the spikes in the 
recording, based on the typical spike shapes obtained in the learning stage. In our classification 
scheme we make use of the information given by the shape of the detected spike as well 
as the firing rates of the different neurons. Although the shape plays in general the most 
important role in the classification, the rates become a more significant factor when dealing 
with overlapping events. This is because in general overlap is considerably less frequent than 
single spikes. The shape information is given by d set of features extracted from the waveform. 
Let x be the feature vector of the detected spike (e.g. the samples of the spike waveform). Let 
N, ..., N,, represent the different neurons. The detection algorithm tells us only that at least 
one spike occurred in the narrow interval (t - T, t + T) (= say I) where t is the instant of 
the peak of the detected spike, T and Tg are constants chosen subjectively according to the 
smallest possible time separation between two consecutive spikes, identifiable as two separate 
(nonoverlapping) spikes. By definition, if more than one spike occurs in the interval I, then 
we have an overlap. As a matter of convention, the instant of the occurrence of a spike  
taken to be that of the spike peak. For simplicity, we will consider the case of two possibly 
overlapping spikes, though the method can be extended easily to more. The classification rule 
which results in minimum probability of error is the one which chooses the neuron (or pair of 
neurons in case of overlap) which has the maximum likelihood. We have therefore to compare 
the Pi's and the Py's, defined as 
= p(N, fed in Ix, A), 
i ---- 1, ..., n 
as = P(N and NS fired in/Ix, A), 
l,j=l,...,n, 
where A represents the event that one or two spikes occurred in the interval I. In other words 
Pi the probability that what has been detected is a single spike from neuron i, whereas 
is the probability that we have two overlapping spikes from neurons I and j (note that spikes 
from the same neuron never overlap). Henceforth we will use f to denote probability density. 
For the purpose of abbreviation let Bi(t) mean neuron Ni fired at t. The classification 
problem can be reduced to comparing the following likelihood functions: 
ft+ T2 
Li = f(Bi(t))a,_r ' f(xlBi(t,))dZ,, i= 1,...,r (la) 
t + T: ft + T: 
= f(xlBt(tx),Bs(t=))dt,dt= , l,j= 1,...,n, j < I (lb) 
(for a derDation refer to AppendN). Let fi be the density of the inter-spe interval d ri be 
the most recent firg instant of neuron Ni. ff we e given the ft that neuron Ni h been 
idle for at let a period of duration t - ri, we get 
= 
(2} 
A disadvantage of using (2) is that the available fi's and ri's are only estimates, which depend 
on the previous classification results, Further, for reliable estimation of the densities fi, one 
needs a large number of spikes and therefore a long learning period since we are estimating a 
98 
whole function. Therefore, we have not used this form, but instead have used the following two 
schemes. In the first one, we ignore the knowledge about the previous firing pattern except 
for the estimated firing rates ,l, ...,An of the different neurons N1, ...,Nn respectively. Then 
the probability of a spike coming from neuron Ni in an interval of duration dt is simply Aidt. 
Hence 
i(B(0) = (3) 
In the second scheme we do not use any previous knowledge except for the total firing rate (of 
all neurons), say a. Then 
f(Bi(t)) = --. (4) 
n 
Although the second scheme does not use as much of the information about the firing 
pattern as the first scheme does, it has the advantage of obtaining and using a more reliable 
estimate of the firing rate, because in general the overall firing rate changes less with time than 
the individual rates and because the estimate of a does not depend on previous classification 
results. However, it is useful mostly when the firing rates
