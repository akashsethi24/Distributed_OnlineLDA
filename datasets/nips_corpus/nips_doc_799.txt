Decoding Cursive Scripts 
Yoram Singer and Naftali Tishby 
Institute of Computer Science and 
Center for Neural Computation 
Hebrew University, Jerusalem 91904, Israel 
Abstract 
Online cursive handwriting recognition is currently one of the most 
intriguing challenges in pattern recognition. This study presents a 
novel approach to this problem which is composed of two comple- 
mentary phases. The first is dynamic encoding of the writing tra- 
jectory into a compact sequence of discrete motor control symbols. 
In this compact representation we largely remove the redundancy of 
the script, while preserving most of its intelligible components. In 
the second phase these control sequences are used to train adaptive 
probabilistic acyclic automata (PAA) for the important ingredients 
of the writing trajectories, e.g. letters. We present a new and effi- 
cient learning algorithm for such stochastic automata, and demon- 
strate its utility for spotting and segmentation of cursive scripts. 
Our experiments show that over 90% of the letters are correctly 
spotted and identified, prior to any higher level language model. 
Moreover, both the training and recognition algorithms are very 
efficient compared to other modeling methods, and the models are 
'on-line' adaptable to other writers and styles. 
1 Introduction 
While the emerging technology of pen-computing is already available on the world's 
markets, there is an on growing gap between the state of the hardware and the 
quality of the available online handwriting recognition algorithms. Clearly, the 
critical requirement for the success of this technology is the availability of reliable 
and robust cursive handwriting recognition methods. 
833 
834 Singer and Tishby 
We have previously proposed a dynamic encoding scheme for cursive handwriting 
based on an oscillatory model of handwriting [8, 9] and demonstrated its power 
mainly through analysis by synthesis. Here we continue with this paradigm and use 
the dynamic encoding scheme as the front-end for a complete stochastic model of 
cursive script. 
The accumulated experience in temporal pattern recognition in the past 30 years 
has yielded some important lessons relevant to handwriting. The first is that one 
can not predefine the basic 'units' of such temporal patterns due to the strong inter- 
action, or 'coarticulation', between such units. Any reasonable model must allow for 
the large variability of the basic handwriting components in different contexts and 
by different writers. Thus true adaptability is a key ingredient of a good stochas- 
tic model of handwriting. Most, if not all, currently used models of handwriting 
and speech are hard to adapt and require vast amounts of training data for some 
robustness in performance. In this paper we propose a simpler stochastic modeling 
scheme, which we call Probabilistic Acyclic Automata (PAA), with the important 
feature of being adaptive. The training algorithm modifies the architecture and 
dimensionality of the model while optimizing its predictive power. This is achieved 
through the minimization of the description length of the model and training 
sequences, following the minimum description length (MDL) principle. Another 
interesting feature of our algorithm is that precisely the same procedure is used in 
both training and recognition phases, which enables continuous adaptation. 
The structure of the paper is as follows. In section 2 we review our dynamic en- 
coding method, used as the front-end to the stochastic modeling phase. We briefly 
describe the estimation and quantization process, and show how the discrete motor 
control sequences are estimated and used, in section 3. Section 4 deals with our 
stochastic modeling approach and the PAA learning algorithm. The algorithm is 
demonstrated by the modeling of handwritten letters. Sections 5 and 6 deal with 
preliminary applications of our approach to segmentation and recognition of cursive 
handwriting. 
2 Dynamic encoding of cursive handwriting 
Motivated by the oscillatory motion model of handwriting, as described e.g. by 
Holierbach in 1981 [2], we developed a parameter estimation and regularization 
method which serves for the analysis, synthesis and coding of cursive handwriting. 
This regularization technique results in a compact and efficient discrete representa- 
tion of handwriting. 
Handwriting is generated by the human muscular motor system, which can be sim- 
plified as spring muscles near a mechanical equilibrium state. When the movements 
are small it is justified to assume that the spring muscles operate in the linear 
regime, so the basic movements are simple harmonic oscillations, superimposed by 
a simple linear drift. Movements are excited by selecting a pair of agonist-antagonist 
muscles that are modeled by the spring pair. In a restricted form this simple motion 
is described by the following two equations, 
V(t) : d:(t): a cos(o:.t + c)) + c Vy(t) : (t) -- bcos(o:yt) , (1) 
where Vx(t) and Vy(t) are the horizontal and vertical pen velocities respectively, wx 
and wy are the angular velocities, a, b are the velocity amplitudes,  is the relative 
Decoding Cursive Scripts 835 
phase lag, and c is the horizontal drift velocity. Assuming that these describe 
the true trajectory, the horizontal drift, c, is estimated as the average horizontal 
1 N 
velocity, b = y -]i=l V:(i). For fixed values of the parameters a, b, a; and d these 
equations describe a cycloidal trajectory. 
Our main assumption is that the cycloidal trajectory is the natural (free) pen mo- 
tion, which is modified only at the velocity zero crossings. Thus changes in the 
dynamical parameters occur only at the zero crossings and preserve the continuity 
of the velocity field. This assumption implies that the angular velocities w,wy 
and amplitudes a, b can be considered constant between consecutive zero crossings. 
Denoting by t' and t, the i'th zero crossing locations of the horizontal and vertical 
velocities, and by L and L, the horizontal and vertical progression during the i'th 
interval, then the estimated amplitudes are, a - �7  �  Those 
2(t+_t,) , b = 2(t,y+l_t,y). 
amplitudes define the vertical and horizontal scales of the written letters. 
Examination of the vertical velocity dynamics reveals the following: (a) There is 
a virtual center of the vertical movement and velocity trajectory is approximately 
symmetric around this center. (b) The vertical velocity zero crossings occur while 
the pen is at almost fixed vertical levels which correspond to high, normal and low 
modulation values, yielding altogether 5 quantized levels. The actual pen levels 
achieved at the vertical velocity zero crossings vary around the quantized values, 
with approximately normal distribution. Let the indicator, It (It  {1,..., 5}), 
be the most probable quantized level when the pen is at the position obtained at 
the t'th zero crossing. We need to estimate concurrently the 5 quantized levels 
H,..., Hs, their variance cr (assumed the same for all levels), and the indicators 
It. In this model the observed data is the sequence of actual pen levels L(t), while 
the complete data is the sequence of levels and indicators {It,L(t)}. The task of 
estimating the parameters {Hi, or} is performed via maximum likelihood estimation 
from incomplete data, commonly done by the �M algorithm[i] and described in [9]. 
The horizontal amplitude is similarly quantized to 3 levels. 
After performing slant equalization of the handwriting, namely, orthogonalizing the 
x and y motions, the velocities l;(t), (t) become approximately uncorrelated. 
When w  wy, the two velocities are uncorrelated if there is a -t-900 phase-lag 
between V: and l/s. There are also locations of total halt in both velocities (no pen 
movement) which we take as a zero phase lag. Considering the vertical oscillations 
as a 'master clock', the horizontal oscillations can be viewed as a 'slave clock' whose 
phase and amplitude vary around the 'master clock'. For English cursive writing, 
1 1 2} thus V 
the frequency ratio between the two clocks is limited to the set {5, , , 
induces a grid for the possible V zero crossings. The phase-lag of the horizontal 
oscillation is therefore restricted to the values 0 �, 4-900 at the zero crossings of 
V. The most likely phase-lag trajectory is determined by dynamic programming 
over the entire grid. At the end of this process the horizontal oscillations are fully 
determined by the vertical oscillations and the pen trajectory's description greatly 
simplified. 
The variations in the vertical angular velocity for a given writer are small, except 
in short intervals where the writer hesitates or stops. The only information that 
should be preserved is the typical vertical angular velocity, denoted by w. The 
836 Singer and Tishby 
normalized discretized equations of motion now become, 
{  : aisin(wt q-j)q- 1 ai G {A,A,A} j  {-900,00,90 �} 
 = bsin(wt) b  {Ht2 - Ht 11 < 1,12 _< 5} (2) 
We used analysis by synthesis technique in order to verify our assumptions and 
estimation scheme. The final result of the whole process is depicted in Fig. 1, 
where the original handwriting is plotted together with its reconstruction from the 
discrete representation. 
Figure 1: The original and the fully quantized cursive scripts. 
3 Discrete control sequences 
The process described in the previous section results in a many to one mapping 
from the continuous velocity field, V:(t), Vy(t), to a discrete set of symbols. This 
set is composed of the cartesian product of the quantized vertical and horizontal 
amplitudes and the phase-lags between these velocities. We treat this discrete con- 
trol sequence as a cartesian product time series. Using the value '0' to indicate 
that the corresponding oscillation continues with the same dynamics, a change in 
the phase lag can be encoded by setting the code to zero fo
